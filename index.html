<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë³„ë˜¥ë³„ ì¡ê¸°</title>
  <style>
    /* ê¸°ë³¸ ë ˆì´ì•„ì›ƒ */
    :root{ --bg:#071129; --panel:#0f2440; --accent:#ffd24a }
    html,body{ height:100%; margin:0; font-family: 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif; background:linear-gradient(180deg,var(--bg),#051023); color:#fff }
    .wrap{ min-height:100%; display:flex; align-items:center; justify-content:center; gap:24px; padding:36px }
    .card{ background:linear-gradient(180deg,var(--panel),#092033); border-radius:12px; padding:14px; box-shadow:0 8px 30px rgba(0,0,0,0.6); }
    canvas{ display:block; background: radial-gradient(1200px 600px at 10% 10%, rgba(255,255,255,0.02), transparent), url('') ; border-radius:8px }
    .ui{ display:flex; gap:12px; align-items:center }
    .info{ display:flex; gap:12px; align-items:center; }
    .btn{ background:transparent; border:1px solid rgba(255,255,255,0.08); padding:8px 12px; border-radius:8px; cursor:pointer; color:#fff }
    .btn:hover{ transform:translateY(-2px) }
    .big{ font-weight:700; font-size:18px }
    .small{ font-size:13px; color:rgba(255,255,255,0.7) }
    @media (max-width:600px){ .wrap{ padding:16px; } }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" style="width:760px;">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px">
        <div>
          <div class="big">ë³„ë˜¥ë³„ ì¡ê¸° ğŸŒ </div>
          <div class="small">í™”ì‚´í‘œ í‚¤(â† â†’) ë˜ëŠ” A/Dë¡œ ì´ë™í•˜ì„¸ìš”. ëª¨ë°”ì¼ì€ í™”ë©´ í„°ì¹˜ë¡œ ì´ë™.</div>
        </div>
        <div class="ui">
          <div class="info">
            <div class="small">ì ìˆ˜</div>
            <div id="score" class="big" style="margin-left:8px">0</div>
          </div>
          <div class="info">
            <div class="small">ëª©ìˆ¨</div>
            <div id="lives" class="big" style="margin-left:8px">3</div>
          </div>
          <button id="startBtn" class="btn">ì‹œì‘</button>
          <button id="restartBtn" class="btn">ì´ˆê¸°í™”</button>
        </div>
      </div>

      <canvas id="gameCanvas" width="720" height="400"></canvas>

      <div class="small" style="margin-top:10px; color:rgba(255,255,255,0.7)">
        ì„¤ëª…: ë–¨ì–´ì§€ëŠ” ë³„ì„ ë°”êµ¬ë‹ˆë¡œ ë°›ìœ¼ë©´ ì ìˆ˜ +1. ë°”ë‹¥ì— ë–¨ì–´ì§€ë©´ ëª©ìˆ¨ -1. ë‚œì´ë„ëŠ” ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ì¦ê°€í•©ë‹ˆë‹¤.
      </div>
    </div>
  </div>

<script>
// ë³„ë˜¥ë³„ ì¡ê¸° - ë‹¨ì¼ íŒŒì¼ êµ¬í˜„
// ì‘ì„±: ChatGPT

const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('score');
const livesEl = document.getElementById('lives');
const startBtn = document.getElementById('startBtn');
const restartBtn = document.getElementById('restartBtn');

let game = null;

class Player {
  constructor(){
    this.width = 100;
    this.height = 18;
    this.x = (canvas.width - this.width)/2;
    this.y = canvas.height - this.height - 8;
    this.speed = 6;
    this.color = '#ffd24a';
  }
  move(dir){
    this.x += dir * this.speed;
    this.x = Math.max(0, Math.min(canvas.width - this.width, this.x));
  }
  draw(){
    // ë°”êµ¬ë‹ˆ ëª¨ì–‘
    ctx.fillStyle = this.color;
    roundRect(ctx, this.x, this.y, this.width, this.height, 8, true, false);
    // ì¥ì‹
    ctx.fillStyle = 'rgba(255,255,255,0.12)';
    ctx.fillRect(this.x + 8, this.y + 3, this.width - 16, 2);
  }
}

class Star {
  constructor(x,y,vy,sz){
    this.x = x; this.y = y; this.vy = vy; this.size = sz; this.caught = false; 
    this.angle = Math.random() * Math.PI * 2; // íšŒì „ ì¥ì‹
  }
  update(dt){
    this.y += this.vy * dt;
    this.angle += 0.04;
  }
  draw(){
    // ë‹¨ìˆœí•œ ë³„ ê·¸ë¦¬ê¸°
    ctx.save();
    ctx.translate(this.x, this.y);
    ctx.rotate(this.angle);
    ctx.beginPath();
    for(let i=0;i<5;i++){
      ctx.lineTo(0, -this.size);
      ctx.rotate(Math.PI/5);
      ctx.lineTo(0, -this.size/2);
      ctx.rotate(Math.PI/5);
    }
    ctx.closePath();
    ctx.fillStyle = '#fff4c9';
    ctx.fill();
    ctx.restore();
  }
}

function roundRect(ctx, x, y, w, h, r, fill, stroke) {
  if (typeof r === 'undefined') r = 5;
  ctx.beginPath();
  ctx.moveTo(x + r, y);
  ctx.arcTo(x + w, y, x + w, y + h, r);
  ctx.arcTo(x + w, y + h, x, y + h, r);
  ctx.arcTo(x, y + h, x, y, r);
  ctx.arcTo(x, y, x + w, y, r);
  ctx.closePath();
  if (fill) ctx.fill();
  if (stroke) ctx.stroke();
}

class Game {
  constructor(){
    this.player = new Player();
    this.stars = [];
    this.score = 0;
    this.lives = 3;
    this.elapsed = 0; // ê²½ê³¼ ì‹œê°„
    this.spawnTimer = 0;
    this.spawnInterval = 1000; // ms
    this.running = false;
    this.last = 0;
    this.inputDir = 0;

    // ì…ë ¥
    this.keys = {};
    window.addEventListener('keydown', e => { this.keys[e.key] = true; });
    window.addEventListener('keyup', e => { this.keys[e.key] = false; });

    // í„°ì¹˜ / ë§ˆìš°ìŠ¤ ì´ë™ (ëª¨ë°”ì¼ ì¹œí™”ì )
    canvas.addEventListener('pointerdown', e => this.onPointer(e));
    canvas.addEventListener('pointermove', e => { if(e.pressure>0 || e.buttons) this.onPointer(e); });

    // ë¦¬ì‚¬ì´ì¦ˆ ê³ ë ¤ (ê³ ì • í¬ê¸°ì´ë¼ì„œ ìƒëµ ê°€ëŠ¥)
  }

  start(){
    this.reset();
    this.running = true;
    this.last = performance.now();
    requestAnimationFrame(t => this.frame(t));
  }
  reset(){
    this.stars = [];
    this.score = 0;
    this.lives = 3;
    this.elapsed = 0;
    this.spawnTimer = 0;
    this.spawnInterval = 1000;
    scoreEl.textContent = this.score;
    livesEl.textContent = this.lives;
  }
  stop(){ this.running = false; }

  onPointer(e){
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    // í¬ì¸í„°ë¡œ í”Œë ˆì´ì–´ ì¤‘ì•™ ë§ì¶”ê¸°
    this.player.x = Math.max(0, Math.min(canvas.width - this.player.width, x - this.player.width/2));
  }

  spawnStar(){
    const x = Math.random() * (canvas.width - 30) + 15;
    const size = 8 + Math.random() * 10;
    // ë‚œì´ë„ì— ë”°ë¼ ì†ë„ ì¦ê°€
    const speed = 60 + Math.random()*60 + (this.elapsed/1000) * 6;
    this.stars.push(new Star(x, -20, speed/1000, size));
  }

  update(dt){
    // í‚¤ ì…ë ¥ ì²˜ë¦¬ (A,D, ì¢Œìš°)
    let dir = 0;
    if (this.keys['ArrowLeft'] || this.keys['a'] || this.keys['A']) dir -= 1;
    if (this.keys['ArrowRight'] || this.keys['d'] || this.keys['D']) dir += 1;
    this.player.move(dir);

    // ìë™ ë‚œì´ë„: ì‹œê°„ ì§€ë‚ ìˆ˜ë¡ spawn ë¹ ë¥´ê²Œ
    this.spawnTimer += dt*1000;
    const intervalTarget = Math.max(300, this.spawnInterval - (this.elapsed/1000)*40);
    if (this.spawnTimer > intervalTarget){
      this.spawnTimer = 0;
      this.spawnStar();
    }

    // ë³„ ì—…ë°ì´íŠ¸
    for(let s of this.stars) s.update(dt);

    // ì¶©ëŒ ê²€ì‚¬(í”Œë ˆì´ì–´ ë°”êµ¬ë‹ˆ)
    for(let i = this.stars.length-1; i>=0; i--){
      const s = this.stars[i];
      if (s.y > canvas.height + 30){
        // ë°”ë‹¥ì— ë–¨ì–´ì§€ë©´ ëª©ìˆ¨ ê°ì†Œ
        this.stars.splice(i,1);
        this.lives -= 1;
        livesEl.textContent = this.lives;
        if (this.lives <= 0){ this.running = false; }
        continue;
      }
      // ë‹¨ìˆœ AABB ì¶©ëŒ: ë³„ì´ í”Œë ˆì´ì–´ ì˜ì—­ ì•ˆì— ë“¤ì–´ì˜¤ë©´ ì¡ìŒ
      if (s.x > this.player.x - s.size && s.x < this.player.x + this.player.width + s.size
          && s.y + s.size > this.player.y){
        this.stars.splice(i,1);
        this.score += 1;
        scoreEl.textContent = this.score;
      }
    }

    this.elapsed += dt*1000;
  }

  draw(){
    // ë°°ê²½ë³„
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // ë°¤í•˜ëŠ˜ ê·¸ë¼ë””ì–¸íŠ¸
    const g = ctx.createLinearGradient(0,0,0,canvas.height);
    g.addColorStop(0,'#071129'); g.addColorStop(1,'#02101b');
    ctx.fillStyle = g; ctx.fillRect(0,0,canvas.width,canvas.height);

    // ì‘ì€ ë³„ ì—¬ëŸ¬ê°œ (ì¥ì‹)
    for(let i=0;i<30;i++){
      ctx.fillStyle = 'rgba(255,255,255,0.03)';
      ctx.fillRect((i*97)%canvas.width, (i*53)%canvas.height, 2,2);
    }

    // í”Œë ˆì´ì–´
    this.player.draw();

    // ë³„ ê·¸ë¦¬ê¸°
    for(let s of this.stars) s.draw();

    // ê²Œì„ì˜¤ë²„ í…ìŠ¤íŠ¸
    if (!this.running && this.lives <= 0){
      ctx.fillStyle = 'rgba(0,0,0,0.6)';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#fff';
      ctx.textAlign = 'center';
      ctx.font = '28px sans-serif';
      ctx.fillText('ê²Œì„ ì˜¤ë²„', canvas.width/2, canvas.height/2 - 10);
      ctx.font = '16px sans-serif';
      ctx.fillText('ì´ˆê¸°í™”ë¥¼ ëˆŒëŸ¬ ë‹¤ì‹œ ì‹œì‘í•˜ì„¸ìš”', canvas.width/2, canvas.height/2 + 18);
    }
  }

  frame(ts){
    if (!this.running) return this.draw();
    const dt = Math.min(0.05, (ts - this.last)/1000); // ì•ˆì •ì„±
    this.update(dt);
    this.draw();
    this.last = ts;
    requestAnimationFrame(t => this.frame(t));
  }
}

// ì´ˆê¸°í™”
function init(){
  game = new Game();
  // ë²„íŠ¼ ë°”ì¸ë”©
  startBtn.addEventListener('click', ()=>{
    if (!game.running) game.start();
  });
  restartBtn.addEventListener('click', ()=>{
    game.reset();
    if (!game.running) { game.draw(); }
  });

  // ì²˜ìŒ í™”ë©´ ë Œë”
  game.draw();
}

init();
</script>
</body>
</html>
